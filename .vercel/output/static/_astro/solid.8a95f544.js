const O={context:void 0,registry:void 0};function q(e){O.context=e}function se(){return{...O.context,id:`${O.context.id}${O.context.count++}-`,count:0}}const le=(e,t)=>e===t,T=Symbol("solid-proxy"),ue=Symbol("solid-track"),I={equals:le};let W=J;const x=1,L=2,X={owned:null,cleanups:null,context:null,owner:null};var h=null;let $=null,c=null,d=null,v=null,M=0;function _(e,t){const n=c,r=h,s=e.length===0,l=s?X:{owned:null,cleanups:null,context:null,owner:t===void 0?r:t},u=s?e:()=>e(()=>m(()=>R(l)));h=l,c=null;try{return E(u,!0)}finally{c=n,h=r}}function ie(e,t){t=t?Object.assign({},I,t):I;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=s=>(typeof s=="function"&&(s=s(n.value)),z(n,s));return[Y.bind(n),r]}function we(e,t,n){const r=G(e,t,!1,x);j(r)}function oe(e,t,n){W=he;const r=G(e,t,!1,x),s=Q&&te(h,Q.id);s&&(r.suspense=s),(!n||!n.render)&&(r.user=!0),v?v.push(r):j(r)}function U(e,t,n){n=n?Object.assign({},I,n):I;const r=G(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,j(r),Y.bind(r)}function m(e){if(c===null)return e();const t=c;c=null;try{return e()}finally{c=t}}function ye(e){oe(()=>m(e))}function ce(e){return h===null||(h.cleanups===null?h.cleanups=[e]:h.cleanups.push(e)),e}let Q;function Y(){if(this.sources&&this.state)if(this.state===x)j(this);else{const e=d;d=null,E(()=>K(this),!1),d=e}if(c){const e=this.observers?this.observers.length:0;c.sources?(c.sources.push(this),c.sourceSlots.push(e)):(c.sources=[this],c.sourceSlots=[e]),this.observers?(this.observers.push(c),this.observerSlots.push(c.sources.length-1)):(this.observers=[c],this.observerSlots=[c.sources.length-1])}return this.value}function z(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&E(()=>{for(let s=0;s<e.observers.length;s+=1){const l=e.observers[s],u=$&&$.running;u&&$.disposed.has(l),(u?!l.tState:!l.state)&&(l.pure?d.push(l):v.push(l),l.observers&&Z(l)),u||(l.state=x)}if(d.length>1e6)throw d=[],new Error},!1)),t}function j(e){if(!e.fn)return;R(e);const t=h,n=c,r=M;c=h=e,fe(e,e.value,r),c=n,h=t}function fe(e,t,n){let r;try{r=e.fn(t)}catch(s){return e.pure&&(e.state=x,e.owned&&e.owned.forEach(R),e.owned=null),e.updatedAt=n+1,ee(s)}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?z(e,r):e.value=r,e.updatedAt=n)}function G(e,t,n,r=x,s){const l={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:h,context:null,pure:n};return h===null||h!==X&&(h.owned?h.owned.push(l):h.owned=[l]),l}function F(e){if(e.state===0)return;if(e.state===L)return K(e);if(e.suspense&&m(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<M);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===x)j(e);else if(e.state===L){const r=d;d=null,E(()=>K(e,t[0]),!1),d=r}}function E(e,t){if(d)return e();let n=!1;t||(d=[]),v?n=!0:v=[],M++;try{const r=e();return ae(n),r}catch(r){n||(v=null),d=null,ee(r)}}function ae(e){if(d&&(J(d),d=null),e)return;const t=v;v=null,t.length&&E(()=>W(t),!1)}function J(e){for(let t=0;t<e.length;t++)F(e[t])}function he(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:F(r)}for(O.context&&q(),t=0;t<n;t++)F(e[t])}function K(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const s=r.state;s===x?r!==t&&(!r.updatedAt||r.updatedAt<M)&&F(r):s===L&&K(r,t)}}}function Z(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=L,n.pure?d.push(n):v.push(n),n.observers&&Z(n))}}function R(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const l=s.pop(),u=n.observerSlots.pop();r<s.length&&(l.sourceSlots[u]=r,s[r]=l,n.observerSlots[r]=u)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)R(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function ee(e){throw e}function te(e,t){return e?e.context&&e.context[t]!==void 0?e.context[t]:te(e.owner,t):void 0}const de=Symbol("fallback");function V(e){for(let t=0;t<e.length;t++)e[t]()}function ge(e,t,n={}){let r=[],s=[],l=[],u=0,o=t.length>1?[]:null;return ce(()=>V(l)),()=>{let a=e()||[],g,i;return a[ue],m(()=>{let f=a.length,S,k,P,C,N,b,w,y,A;if(f===0)u!==0&&(V(l),l=[],r=[],s=[],u=0,o&&(o=[])),n.fallback&&(r=[de],s[0]=_(re=>(l[0]=re,n.fallback())),u=1);else if(u===0){for(s=new Array(f),i=0;i<f;i++)r[i]=a[i],s[i]=_(p);u=f}else{for(P=new Array(f),C=new Array(f),o&&(N=new Array(f)),b=0,w=Math.min(u,f);b<w&&r[b]===a[b];b++);for(w=u-1,y=f-1;w>=b&&y>=b&&r[w]===a[y];w--,y--)P[y]=s[w],C[y]=l[w],o&&(N[y]=o[w]);for(S=new Map,k=new Array(y+1),i=y;i>=b;i--)A=a[i],g=S.get(A),k[i]=g===void 0?-1:g,S.set(A,i);for(g=b;g<=w;g++)A=r[g],i=S.get(A),i!==void 0&&i!==-1?(P[i]=s[g],C[i]=l[g],o&&(N[i]=o[g]),i=k[i],S.set(A,i)):l[g]();for(i=b;i<f;i++)i in P?(s[i]=P[i],l[i]=C[i],o&&(o[i]=N[i],o[i](i))):s[i]=_(p);s=s.slice(0,u=f),r=a.slice(0)}return s});function p(f){if(l[i]=f,o){const[S,k]=ie(i);return o[i]=k,t(a[i],S)}return t(a[i])}}}let ne=!1;function ve(){ne=!0}function me(e,t){if(ne&&O.context){const n=O.context;q(se());const r=m(()=>e(t||{}));return q(n),r}return m(()=>e(t||{}))}function D(){return!0}const B={get(e,t,n){return t===T?n:e.get(t)},has(e,t){return t===T?!0:e.has(t)},set:D,deleteProperty:D,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:D,deleteProperty:D}},ownKeys(e){return e.keys()}};function H(e){return(e=typeof e=="function"?e():e)?e:{}}function pe(){for(let e=0,t=this.length;e<t;++e){const n=this[e]();if(n!==void 0)return n}}function xe(...e){let t=!1;for(let l=0;l<e.length;l++){const u=e[l];t=t||!!u&&T in u,e[l]=typeof u=="function"?(t=!0,U(u)):u}if(t)return new Proxy({get(l){for(let u=e.length-1;u>=0;u--){const o=H(e[u])[l];if(o!==void 0)return o}},has(l){for(let u=e.length-1;u>=0;u--)if(l in H(e[u]))return!0;return!1},keys(){const l=[];for(let u=0;u<e.length;u++)l.push(...Object.keys(H(e[u])));return[...new Set(l)]}},B);const n={},r={};let s=!1;for(let l=e.length-1;l>=0;l--){const u=e[l];if(!u)continue;const o=Object.getOwnPropertyNames(u);s=s||l!==0&&!!o.length;for(let a=0,g=o.length;a<g;a++){const i=o[a];if(!(i==="__proto__"||i==="constructor"))if(i in n){const p=r[i],f=Object.getOwnPropertyDescriptor(u,i);p?f.get?p.push(f.get.bind(u)):f.value!==void 0&&p.push(()=>f.value):n[i]===void 0&&(n[i]=f.value)}else{const p=Object.getOwnPropertyDescriptor(u,i);p.get?Object.defineProperty(n,i,{enumerable:!0,configurable:!0,get:pe.bind(r[i]=[p.get.bind(u)])}):n[i]=p.value}}}return n}function Se(e,...t){if(T in e){const s=new Set(t.length>1?t.flat():t[0]),l=t.map(u=>new Proxy({get(o){return u.includes(o)?e[o]:void 0},has(o){return u.includes(o)&&o in e},keys(){return u.filter(o=>o in e)}},B));return l.push(new Proxy({get(u){return s.has(u)?void 0:e[u]},has(u){return s.has(u)?!1:u in e},keys(){return Object.keys(e).filter(u=>!s.has(u))}},B)),l}const n={},r=t.map(()=>({}));for(const s of Object.getOwnPropertyNames(e)){const l=Object.getOwnPropertyDescriptor(e,s),u=!l.get&&!l.set&&l.enumerable&&l.writable&&l.configurable;let o=!1,a=0;for(const g of t)g.includes(s)&&(o=!0,u?r[a][s]=l.value:Object.defineProperty(r[a],s,l)),++a;o||(u?n[s]=l.value:Object.defineProperty(n,s,l))}return[...r,n]}const be=e=>`Stale read from <${e}>.`;function Oe(e){const t="fallback"in e&&{fallback:()=>e.fallback};return U(ge(()=>e.each,e.children,t||void 0))}function Ae(e){const t=e.keyed,n=U(()=>e.when,void 0,{equals:(r,s)=>t?r===s:!r==!s});return U(()=>{const r=n();if(r){const s=e.children;return typeof s=="function"&&s.length>0?m(()=>s(t?r:()=>{if(!m(n))throw be("Show");return e.when})):s}return e.fallback},void 0,void 0)}export{Oe as F,Ae as S,me as a,we as b,ie as c,_ as d,ve as e,oe as f,Se as g,ce as h,xe as m,ye as o,O as s,m as u};
